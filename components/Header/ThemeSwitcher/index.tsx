import { useState, useEffect } from "react";
import ReactSwitch from "react-switch";

const ThemeSwitcher = (): JSX.Element => {
    const [theme, setTheme] = useState<boolean>(true); // true - light, false - dark

    useEffect(() => {
        const themeName = theme ? "light" : "dark";

        document
            .querySelector("#header")
            ?.setAttribute("data-theme", themeName);
        document
            .querySelector("#footer")
            ?.setAttribute("data-theme", themeName);

        document.body.setAttribute("data-theme", themeName);

        document
            .querySelector('[role="switch"]')
            ?.setAttribute("aria-label", "Theme switcher");
    }, [theme]);

    useEffect(() => {
        const themeName = localStorage.getItem("theme");

        if (themeName !== null) {
            setTheme(themeName === "light");
        } else {
            localStorage.setItem("theme", "light");
        }
    }, []);

    const onThemeChangeHandler = () => {
        const themeName = !theme ? "light" : "dark";
        localStorage.setItem("theme", themeName);
        setTheme(!theme);
    };

    return (
        <ReactSwitch
            uncheckedIcon={
                <svg
                    width="18"
                    height="18"
                    viewBox="0 0 18 18"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M13.3471 4.23375L14.226 3.35483C14.3427 3.24562 14.525 3.24871 14.6381 3.36167C14.751 3.47462 14.7541 3.65691 14.6449 3.77378L13.766 4.65269C13.6493 4.7619 13.467 4.75881 13.3539 4.64586C13.2409 4.53274 13.2379 4.35045 13.3471 4.23375ZM4.2129 13.3679L3.33398 14.2468C3.22477 14.3637 3.22786 14.546 3.34082 14.6589C3.45394 14.7719 3.63623 14.775 3.75293 14.6658L4.63184 13.7869C4.74106 13.6702 4.73796 13.4879 4.62501 13.3748C4.51189 13.2618 4.3296 13.2587 4.2129 13.3679ZM13.7658 13.3679C13.6491 13.2587 13.4668 13.2618 13.3537 13.3748C13.2408 13.4879 13.2377 13.6702 13.3469 13.7869L14.2258 14.6658C14.3425 14.775 14.5248 14.7719 14.6379 14.6589C14.7509 14.546 14.7539 14.3637 14.6447 14.2468L13.7658 13.3679ZM4.2129 4.65291C4.3296 4.76213 4.51189 4.75904 4.62501 4.64608C4.73796 4.53296 4.74106 4.35067 4.63184 4.23397L3.75293 3.35505C3.63623 3.24584 3.45394 3.24893 3.34082 3.36189C3.22786 3.47484 3.22477 3.65714 3.33398 3.774L4.2129 4.65291ZM12.4375 11.815C11.6404 12.7907 10.4746 13.3925 9.21761 13.4768C7.96061 13.5609 6.72477 13.1203 5.80469 12.2598C4.88444 11.3992 4.36232 10.1957 4.36232 8.93579C4.40268 6.796 5.89748 4.87329 8.03615 4.46912L8.03631 4.46896C9.2694 4.22596 10.548 4.50379 11.569 5.23654C12.59 5.96929 13.2626 7.09183 13.4271 8.33779C13.5917 9.58371 13.2334 10.8422 12.4375 11.8148L12.4375 11.815ZM11.921 6.35875C11.1888 5.50391 10.1272 5.001 9.0019 4.97562C7.87657 4.95039 6.79357 5.405 6.02357 6.22612C5.25357 7.04708 4.86911 8.15696 4.96644 9.27837C5.06377 10.3998 5.63361 11.4268 6.53365 12.1029C7.43373 12.779 8.57873 13.0402 9.6829 12.8213C10.7871 12.6026 11.7461 11.9242 12.3201 10.9559C12.7363 10.2422 12.9214 9.41716 12.8499 8.59408C12.7784 7.771 12.4541 6.99008 11.921 6.35875V6.35875ZM16.691 8.71437H15.448C15.2885 8.71991 15.1621 8.85093 15.1621 9.0106C15.1621 9.17027 15.2885 9.30129 15.448 9.30682H16.691C16.8505 9.30129 16.977 9.17027 16.977 9.0106C16.977 8.85093 16.8505 8.71991 16.691 8.71437ZM2.53019 8.71437H1.28719C1.12769 8.71991 1.00122 8.85093 1.00122 9.0106C1.00122 9.17027 1.12769 9.30129 1.28719 9.30682H2.53019C2.6897 9.30129 2.81616 9.17027 2.81616 9.0106C2.81616 8.85093 2.6897 8.71991 2.53019 8.71437ZM8.69269 15.4694V16.7124C8.69823 16.8719 8.82925 16.9983 8.98892 16.9983C9.14859 16.9983 9.27961 16.8719 9.28514 16.7124V15.4694C9.27961 15.3097 9.14859 15.1832 8.98892 15.1832C8.82925 15.1832 8.69822 15.3097 8.69269 15.4694ZM9.28515 2.55187V1.30871C9.27962 1.1492 9.1486 1.02274 8.98892 1.02274C8.82925 1.02274 8.69823 1.1492 8.6927 1.30871V2.55171C8.69823 2.71137 8.82925 2.83784 8.98892 2.83784C9.1486 2.83784 9.27962 2.71137 9.28515 2.55171V2.55187Z"
                        fill={theme ? "#ffffff" : "#8A39F8"}
                        stroke={theme ? "#ffffff" : "#8A39F8"}
                        strokeWidth="0.9"
                    />
                </svg>
            }
            checkedIcon={
                <svg
                    width="18"
                    height="18"
                    viewBox="0 0 18 18"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M9.08986 1.01194L9.25377 1.01535C9.31765 1.01683 9.37163 1.01831 9.41709 1.02024C9.62554 1.02854 9.78784 1.20169 9.78 1.40747C9.77551 1.51695 9.72406 1.61381 9.64487 1.6793V1.67975C9.02414 2.19361 8.51918 2.83754 8.17364 3.56855C7.84191 4.27069 7.65636 5.05639 7.65636 5.88769C7.65636 7.40291 8.27815 8.7749 9.28356 9.76785C10.289 10.7609 11.678 11.3751 13.212 11.3751C13.7931 11.3751 14.352 11.2875 14.8758 11.1252C15.4183 10.9575 15.9257 10.7086 16.3836 10.3933C16.5553 10.2754 16.7915 10.3174 16.9108 10.4872C16.9781 10.583 16.994 10.6994 16.9637 10.8036C16.5459 12.5878 15.5226 14.1427 14.1198 15.246C12.7387 16.332 10.9905 16.9808 9.08964 16.9808C6.85748 16.9808 4.83682 16.087 3.37384 14.6421C1.911 13.1972 1.0061 11.2014 1.0061 8.9965C1.0061 6.79157 1.91103 4.79589 3.37384 3.35087C4.83667 1.906 6.8573 1.01221 9.08964 1.01221L9.08986 1.01194ZM7.49042 3.25229C7.74284 2.71785 8.0696 2.22547 8.4567 1.78684C6.68644 1.93645 5.09552 2.70804 3.90981 3.8796C2.58408 5.18905 1.76434 6.99811 1.76434 8.99611C1.76434 10.9945 2.58408 12.8029 3.90981 14.1126C5.23554 15.4221 7.06708 16.2317 9.08992 16.2317C10.8141 16.2317 12.3986 15.644 13.6498 14.6607C14.6894 13.8432 15.4988 12.7528 15.9665 11.4991C15.6888 11.6321 15.4002 11.7456 15.1012 11.8379C14.5037 12.0228 13.8691 12.1229 13.2126 12.1229C11.4691 12.1229 9.89092 11.4247 8.74853 10.2962C7.60605 9.16774 6.89954 7.60895 6.89954 5.88691C6.89954 4.94807 7.11144 4.05484 7.49116 3.25241L7.49042 3.25229Z"
                        fill={theme ? "#8A39F8" : "#ffffff"}
                        stroke={theme ? "#8A39F8" : "#ffffff"}
                        strokeWidth="0.6"
                    />
                </svg>
            }
            className="theme-switcher"
            handleDiameter={100}
            width={70}
            height={40}
            onColor="#f3ebfe"
            offHandleColor="#8A39F8"
            onHandleColor="#8A39F8"
            checked={theme}
            onChange={onThemeChangeHandler}
        />
    );
};

export default ThemeSwitcher;
